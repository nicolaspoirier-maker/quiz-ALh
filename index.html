<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Multi-Joueurs Angers Loire Habitat</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a4d7d;
            --secondary: #e8764b;
            --accent: #f4c430;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --success: #28a745;
            --error: #dc3545;
            --gradient: linear-gradient(135deg, #1a4d7d 0%, #2d6ea0 100%);
        }

        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding: 2rem 0;
        }

        h1 {
            font-family: 'Bebas Neue', cursive;
            font-size: 3.5rem;
            letter-spacing: 4px;
            background: linear-gradient(45deg, var(--accent), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .subtitle {
            font-size: 1.1rem;
            margin-top: 1rem;
            opacity: 0.9;
        }

        .mode-badge {
            display: inline-block;
            background: rgba(40, 167, 69, 0.2);
            color: var(--success);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 1rem;
        }

        /* Card styling */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        /* Role Selection */
        .role-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .role-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .role-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px rgba(244, 196, 48, 0.3);
        }

        .role-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .role-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .role-description {
            font-size: 0.95rem;
            opacity: 0.8;
        }

        /* Admin Panel */
        .admin-controls {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .session-info {
            background: rgba(244, 196, 48, 0.1);
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid var(--accent);
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            text-align: center;
        }

        /* Team Selection */
        .team-input {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        input[type="text"], select {
            flex: 1;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--light);
            font-size: 1.1rem;
            font-family: 'Work Sans', sans-serif;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.15);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        select {
            cursor: pointer;
        }

        select option {
            background: var(--dark);
            color: var(--light);
        }

        button {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-family: 'Work Sans', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 20px rgba(26, 77, 125, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(26, 77, 125, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        /* Teams Grid */
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .team-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .team-card.active {
            border-color: var(--accent);
            box-shadow: 0 5px 20px rgba(244, 196, 48, 0.3);
        }

        .team-name {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .team-status {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .team-answered {
            color: var(--success);
            font-weight: 600;
        }

        /* Theme Grid */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .theme-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .theme-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px rgba(244, 196, 48, 0.3);
        }

        .theme-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .theme-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--accent);
        }

        .theme-info {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Question Display */
        .question-container {
            margin-bottom: 2rem;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 8px;
            border-radius: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient);
            transition: width 0.5s ease;
            box-shadow: 0 0 20px rgba(244, 196, 48, 0.5);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .question-number {
            font-family: 'Bebas Neue', cursive;
            font-size: 2rem;
            color: var(--accent);
        }

        .question-type {
            background: rgba(244, 196, 48, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.6rem;
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 2rem;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .answer-option {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .answer-option:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }

        .answer-option.selected {
            background: rgba(244, 196, 48, 0.2);
            border-color: var(--accent);
            box-shadow: 0 5px 20px rgba(244, 196, 48, 0.3);
        }

        .answer-option.correct {
            background: rgba(40, 167, 69, 0.2);
            border-color: var(--success);
        }

        .answer-option.incorrect {
            background: rgba(220, 53, 69, 0.2);
            border-color: var(--error);
        }

        .answer-option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .answer-label {
            font-weight: 700;
            color: var(--accent);
            margin-right: 0.5rem;
        }

        /* Waiting State */
        .waiting-message {
            text-align: center;
            padding: 3rem;
            background: rgba(244, 196, 48, 0.1);
            border-radius: 15px;
            border: 2px dashed var(--accent);
        }

        .waiting-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Scores */
        .scores-grid {
            display: grid;
            gap: 1rem;
        }

        .score-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .score-rank {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--accent);
            width: 50px;
        }

        .score-name {
            flex: 1;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .score-points {
            font-size: 1.3rem;
            font-weight: 700;
        }

        /* Review */
        .review-container {
            display: grid;
            gap: 2rem;
        }

        .review-question {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .review-header {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }

        .review-number {
            font-family: 'Bebas Neue', cursive;
            font-size: 1.5rem;
            color: var(--accent);
        }

        .review-text {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .review-answer {
            background: rgba(40, 167, 69, 0.2);
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid var(--success);
            margin: 1rem 0;
        }

        .review-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 10px;
            margin-top: 1rem;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .explanation-title {
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        /* Utility */
        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 2rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .question-text {
                font-size: 1.3rem;
            }

            .answers-grid {
                grid-template-columns: 1fr;
            }

            .role-selection {
                grid-template-columns: 1fr;
            }
        }

        /* Status Indicator */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-online {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        .status-waiting {
            background: var(--accent);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>QUIZ ANGERS LOIRE HABITAT</h1>
            <p class="subtitle">Challenge Multi-Joueurs en Temps R√©el</p>
            <div class="mode-badge">
                <span class="status-indicator status-online"></span>
                Mode Multi-Joueurs Actif
            </div>
        </header>

        <!-- Role Selection Screen -->
        <div id="roleScreen" class="card">
            <h2 class="text-center" style="font-size: 2rem; margin-bottom: 2rem;">Choisissez votre r√¥le</h2>
            <div class="role-selection">
                <div class="role-card" onclick="selectRole('admin')">
                    <div class="role-icon">üë®‚Äçüíº</div>
                    <div class="role-title">Administrateur</div>
                    <div class="role-description">
                        Cr√©er la session, g√©rer les √©quipes, lancer les questions
                    </div>
                </div>
                <div class="role-card" onclick="selectRole('player')">
                    <div class="role-icon">üéÆ</div>
                    <div class="role-title">Joueur</div>
                    <div class="role-description">
                        Rejoindre une session existante et r√©pondre aux questions
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Setup Screen -->
        <div id="adminSetupScreen" class="hidden card">
            <h2 style="font-size: 2rem; margin-bottom: 2rem;">Configuration Administrateur</h2>
            
            <div class="admin-controls">
                <button class="btn-primary" onclick="createSession()">
                    üéØ Cr√©er une Nouvelle Session
                </button>
                
                <div id="sessionIdDisplay" class="hidden">
                    <div class="session-info">
                        ID de Session : <span id="sessionId"></span>
                    </div>
                    <p style="text-align: center; margin-top: 1rem; opacity: 0.8;">
                        Partagez cet ID avec les participants
                    </p>
                </div>
            </div>

            <div id="teamManagement" class="hidden">
                <h3 style="margin: 2rem 0 1rem 0; font-size: 1.5rem;">Gestion des √âquipes</h3>
                <div class="team-input">
                    <input type="text" id="teamNameInput" placeholder="Nom de l'√©quipe..." maxlength="30">
                    <button class="btn-primary" onclick="addTeam()">Ajouter √âquipe</button>
                </div>
                
                <div id="teamsGrid" class="teams-grid"></div>

                <div class="controls mt-2">
                    <button class="btn-success" onclick="startQuizSession()" style="font-size: 1.2rem; padding: 1.5rem 3rem;">
                        üöÄ Lancer le Quiz
                    </button>
                </div>
            </div>
        </div>

        <!-- Player Join Screen -->
        <div id="playerJoinScreen" class="hidden card">
            <h2 style="font-size: 2rem; margin-bottom: 2rem;">Rejoindre une Session</h2>
            
            <div class="team-input">
                <input type="text" id="sessionIdInput" placeholder="Entrez l'ID de session..." maxlength="10">
                <button class="btn-primary" onclick="validateSession()">V√©rifier</button>
            </div>

            <div id="teamSelection" class="hidden">
                <h3 style="margin: 2rem 0 1rem 0; font-size: 1.5rem;">S√©lectionnez votre √©quipe</h3>
                <select id="teamSelect" size="5" style="width: 100%; min-height: 200px;">
                </select>
                <div class="controls mt-2">
                    <button class="btn-primary" onclick="joinAsTeam()">Rejoindre en tant que cette √©quipe</button>
                </div>
            </div>
        </div>

        <!-- Theme Selection Screen (Admin Only) -->
        <div id="themeScreen" class="hidden card">
            <h2 class="text-center" style="font-size: 2rem; margin-bottom: 2rem;">S√©lectionnez une Th√©matique</h2>
            <div id="themeGrid" class="theme-grid"></div>
            <div class="controls mt-2">
                <button class="btn-secondary" onclick="showFinalScores()">üìä Voir le Classement G√©n√©ral</button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <div class="card">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
                
                <div class="question-container">
                    <div class="question-header">
                        <div class="question-number" id="questionNumber">Question 1/15</div>
                        <div class="question-type" id="questionType">QCM</div>
                    </div>
                    <div class="question-text" id="questionText"></div>
                    <div id="answersGrid" class="answers-grid"></div>
                </div>

                <div id="playerWaiting" class="hidden waiting-message">
                    <div class="waiting-icon">‚è≥</div>
                    <h3>R√©ponse enregistr√©e !</h3>
                    <p>En attente des autres √©quipes...</p>
                </div>

                <div class="controls">
                    <button class="btn-primary" onclick="submitAnswer()" id="submitBtn">Valider ma R√©ponse</button>
                    <button class="btn-secondary hidden" onclick="nextQuestion()" id="nextBtn">Question Suivante</button>
                </div>
            </div>

            <div class="card">
                <h3 style="margin-bottom: 1.5rem; font-size: 1.5rem;">√âtat des √âquipes</h3>
                <div id="teamAnswersGrid" class="teams-grid"></div>
            </div>
        </div>

        <!-- Scores Screen -->
        <div id="scoresScreen" class="hidden card">
            <h2 class="text-center" style="font-size: 2.5rem; margin-bottom: 2rem;">
                Classement - <span id="currentThemeName"></span>
            </h2>
            <div id="scoresContainer" class="scores-grid"></div>
            <div class="controls mt-2">
                <button class="btn-primary" onclick="showReview()">üìñ Voir les R√©ponses</button>
            </div>
        </div>

        <!-- Review Screen -->
        <div id="reviewScreen" class="hidden card">
            <h2 class="text-center" style="font-size: 2.5rem; margin-bottom: 2rem;">
                R√©capitulatif - <span id="reviewThemeName"></span>
            </h2>
            <div id="reviewContainer" class="review-container"></div>
            <div class="controls mt-2">
                <button class="btn-primary" onclick="backToThemes()">üéØ Nouvelle Th√©matique</button>
            </div>
        </div>

        <!-- Final Scores Screen -->
        <div id="finalScoresScreen" class="hidden card">
            <h2 class="text-center" style="font-size: 3rem; margin-bottom: 2rem;">
                üèÜ CLASSEMENT G√âN√âRAL FINAL üèÜ
            </h2>
            <div id="finalScoresContainer" class="scores-grid"></div>
            <div class="controls mt-2">
                <button class="btn-primary" onclick="backToThemes()">üéØ Continuer</button>
                <button class="btn-danger" onclick="resetSession()">üîÑ Nouvelle Session</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== QUIZ DATA ====================
        
        // DONN√âES COMPL√àTES - Format condens√© pour optimisation
        const quizDataCompact = // DONN√âES COMPL√àTES DU QUIZ - 9 TH√âMATIQUES
{
    "1. Principes g√©n√©raux et priorit√©s": [
        {q:"Quel est le r√¥le principal du CCCP pour Angers Loire Habitat ?",t:"QCM",a:["Un document indicatif sans valeur prescriptive","Un outil prescriptif rappelant les attentes de l'OPH","Un guide architectural optionnel","Un document exclusivement r√©glementaire"],c:1,e:"Le CCCP est explicitement d√©fini comme un outil prescriptif, adapt√© aux programmes et aux client√®les, servant de rappel des attentes et exigences de l'OPH.",r:"CCCP - Pr√©ambule"},
        {q:"Angers Loire Habitat limite ses exigences aux seules obligations r√©glementaires.",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Le document pr√©cise clairement que les exigences vont au-del√† des obligations r√©glementaires, notamment sur les volets environnementaux, d'usage et d'accessibilit√©.",r:"CCCP - Pr√©ambule"},
        {q:"Quelle orientation doit √™tre √©vit√©e pour les logements, sauf contrainte sp√©cifique ?",t:"QCM",a:["Est","Ouest","Nord","Sud"],c:2,e:"Les logements mono-orient√©s Nord sont √† √©viter, sauf contraintes topographiques av√©r√©es.",r:"CCCP - Le logement"},
        {q:"La s√©paration des espaces jour et nuit constitue une attente explicite du CCCP.",t:"Vrai/Faux",a:["Vrai","Faux"],c:0,e:"La s√©paration jour/nuit est list√©e comme une exigence fonctionnelle visant le confort d'usage et l'intimit√© des occupants.",r:"CCCP - Le logement"},
        {q:"Pour quels types de logements la priorit√© PMR est-elle explicitement mentionn√©e ?",t:"QCM",a:["T4 et T5","Tous les logements","T2 et T3","Uniquement les logements s√©niors"],c:2,e:"Les logements PMR sont prioritaires sur les T2 et T3, avec des dispositifs favorisant l'√©volutivit√©.",r:"CCCP - Le logement"},
        {q:"La cuisine doit √™tre totalement ferm√©e afin de limiter les nuisances.",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"La cuisine doit √™tre semi-ouverte, avec une cloison toute hauteur permettant une d√©limitation fonctionnelle sans rupture d'usage avec le s√©jour.",r:"CCCP - Cuisine"},
        {q:"Quelle est la surface minimale exig√©e pour un s√©jour en T3 ?",t:"QCM",a:["20 m¬≤","21 m¬≤","22 m¬≤","24 m¬≤"],c:2,e:"Le tableau des surfaces habitables fixe la surface minimale du s√©jour d'un T3 √† 22 m¬≤ SH.",r:"CCCP - Surfaces"},
        {q:"L'acc√®s au balcon ou √† la terrasse doit se faire sans ressaut pour les logements accessibles.",t:"Vrai/Faux",a:["Vrai","Faux"],c:0,e:"Un ressaut maximal de 2 cm est tol√©r√© afin de garantir l'accessibilit√© PMR vers les espaces ext√©rieurs.",r:"CCCP - S√©jour"},
        {q:"Quel est le nombre maximal de logements recommand√© par entr√©e en collectif ?",t:"QCM",a:["15 logements","20 logements","25 logements","30 logements"],c:1,e:"Le CCCP limite volontairement le nombre de logements par entr√©e √† une vingtaine afin de conserver une √©chelle r√©sidentielle et qualitative.",r:"CCCP - Entr√©e"},
        {q:"Les halls d'entr√©e doivent comporter un sas syst√©matique pour des raisons thermiques.",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Le CCCP pr√©cise explicitement : Hall d'entr√©e sans sas, avec traitement soign√© de l'isolation des circulations en rez-de-chauss√©e.",r:"CCCP - Entr√©e"},
        {q:"Quel dispositif √©nerg√©tique est attendu dans la conception des b√¢timents ?",t:"QCM",a:["Chauffage exclusivement gaz","G√©othermie obligatoire","Photovolta√Øque en autoconsommation des parties communes","Absence de production locale d'√©nergie"],c:2,e:"Le CCCP impose l'int√©gration de solaire photovolta√Øque en autoconsommation pour les parties communes.",r:"CCCP - Conception"},
        {q:"La biodiversit√© est trait√©e uniquement en p√©riph√©rie du site.",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Le document impose un recensement des esp√®ces sur site et la mise en ≈ìuvre de mesures concr√®tes (nichoirs, pierriers, infiltration √† la parcelle).",r:"CCCP - Biodiversit√©"},
        {q:"Pourquoi Angers Loire Habitat est-il particuli√®rement vigilant sur le respect des surfaces habitables ?",t:"QCM",a:["Pour faciliter la commercialisation","Pour respecter les normes incendie","Pour garantir le confort et ma√Ætriser les loyers","Pour simplifier la conception"],c:2,e:"Chaque m¬≤ suppl√©mentaire impacte directement le loyer  le respect strict des surfaces est donc un levier de ma√Ætrise √©conomique et sociale.",r:"CCCP - Surfaces"},
        {q:"Un d√©passement ponctuel des surfaces est encourag√© pour am√©liorer le confort.",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Le CCCP insiste sur le respect strict des surfaces demand√©es, pr√©cis√©ment pour √©viter toute d√©rive de loyer.",r:"CCCP - Surfaces"},
        {q:"Quelle est la profondeur minimale exig√©e pour un balcon ?",t:"QCM",a:["1,50 m","1,70 m","1,90 m","2,20 m"],c:2,e:"La profondeur minimale de 1,90 m est exig√©e afin de garantir un usage r√©el (repas, d√©tente).",r:"CCCP - Balcon"}
    ],
    
    "2. Logement S√©nior": [
        {q:"Quelles sont les dimensions optimales de la chambre principale (hors placard) ?",t:"QCM",a:["320 cm x 280 cm","380 cm x 290 cm","420 cm x 310 cm","450 cm x 350 cm"],c:2,e:"Les dimensions optimales sont de 420 cm x 310 cm, auxquelles s'ajoute un placard de 60 cm x 120 cm minimum.",r:"CCCP - Logement S√©nior"},
        {q:"Quelle est la distance minimale requise de chaque c√¥t√© du lit dans la chambre principale ?",t:"QCM",a:["60 cm","70 cm","80 cm","90 cm"],c:3,e:"Une distance de 90 cm de chaque c√¥t√© du lit permet le passage d'un fauteuil roulant ou l'installation d'un l√®ve-personne.",r:"CCCP - Logement S√©nior"},
        {q:"Quelle est la largeur de passage minimale au pied du lit dans la chambre ?",t:"QCM",a:["90 cm","100 cm","110 cm","120 cm"],c:3,e:"La largeur de passage minimale au pied du lit est de 120 cm pour permettre une circulation ais√©e.",r:"CCCP - Logement S√©nior"},
        {q:"Comment doit √™tre positionn√©e la t√™te du lit par rapport √† la fen√™tre ?",t:"QCM",a:["Parall√®le √† la fen√™tre","Face √† la fen√™tre","Perpendiculaire √† la fen√™tre","Peu importe l'orientation"],c:2,e:"La t√™te du lit doit √™tre perpendiculaire √† la fen√™tre pour √©viter d'√™tre aveugl√© et offrir une vue vers l'ext√©rieur.",r:"CCCP - Logement S√©nior"},
        {q:"Quelles dimensions minimales sont requises pour le placard de la chambre principale ?",t:"QCM",a:["50 cm x 100 cm","60 cm x 120 cm","70 cm x 140 cm","80 cm x 150 cm"],c:1,e:"Un placard avec portes coulissantes de 60 cm x 120 cm minimum doit √™tre pr√©vu.",r:"CCCP - Logement S√©nior"},
        {q:"Quel dispositif d'√©clairage sp√©cifique doit √™tre install√© entre la chambre et les autres pi√®ces ?",t:"QCM",a:["Des veilleuses branch√©es sur prise","Un chemin lumineux avec √©clairage nocturne LED sans √©blouissement","Un √©clairage central puissant","Des interrupteurs phosphorescents uniquement"],c:1,e:"Un chemin lumineux avec √©clairage nocturne LED doit √™tre install√© entre la chambre et les WC, SDE et cuisine.",r:"CCCP - Logement S√©nior"},
        {q:"Comment doivent √™tre command√©s tous les volets roulants du logement ?",t:"QCM",a:["Manuellement avec sangle","Par t√©l√©commande sans fil uniquement","Motoris√©s avec inverseur filaire et micro-module domotique","Par manivelle"],c:2,e:"Tous les volets roulants sont motoris√©s, filaires et command√©s par inverseur avec micro-module domotique.",r:"CCCP - Logement S√©nior"},
        {q:"Que permet le bouton de sortie de logement reli√© √† la domotique ?",t:"QCM",a:["Uniquement l'extinction des lumi√®res","Commande centralis√©e : √©teindre luminaires, fermer VR, chauffage en mode √©co","Seulement la fermeture de la porte d'entr√©e","Activer l'alarme uniquement"],c:1,e:"Le bouton √©co-touch permet une commande centralis√©e : √©teindre luminaires, fermer volets, mettre chauffage en √©co.",r:"CCCP - Logement S√©nior"},
        {q:"Quel type de rev√™tement de sol est pr√©conis√© dans toutes les pi√®ces s√®ches du logement ?",t:"QCM",a:["Carrelage uniquement","Parquet flottant","Rev√™tement PVC U2SP3","Moquette √©paisse"],c:2,e:"Le rev√™tement PVC U2SP3 offre un meilleur confort dans le d√©placement et un bon roulement des fauteuils roulants.",r:"CCCP - Logement S√©nior"},
        {q:"Dans la cuisine, quelle distance minimale de rayon de giration doit √™tre respect√©e ?",t:"QCM",a:["120 cm","130 cm","140 cm","150 cm"],c:3,e:"Le rayon de giration de 150 cm doit √™tre respect√© pour permettre la man≈ìuvre d'un fauteuil roulant.",r:"CCCP - Logement S√©nior"},
        {q:"Comment doivent √™tre positionn√©s l'√©vier et la plaque de cuisson dans la cuisine ?",t:"QCM",a:["√âloign√©s l'un de l'autre pour la s√©curit√©","Proches l'un de l'autre pour faire glisser une casserole sans la soulever","L'√©vier obligatoirement sous la fen√™tre","Peu importe leur positionnement"],c:1,e:"L'√©vier et la plaque doivent √™tre proches pour pouvoir faire glisser une casserole de l'un √† l'autre sans la soulever.",r:"CCCP - Logement S√©nior"},
        {q:"Quelles sont les dimensions minimales recommand√©es pour une douche adapt√©e ?",t:"QCM",a:["80 cm x 100 cm","90 cm x 110 cm","90 cm x 120 cm","100 cm x 140 cm"],c:2,e:"La douche doit avoir une dimension minimum de 90 cm x 120 cm, en niche avec 3 parois fa√Øenc√©es.",r:"CCCP - Logement S√©nior"},
        {q:"Combien de porte(s) √† galandage maximum doit comporter le logement ?",t:"QCM",a:["Aucune porte √† galandage n'est autoris√©e","1 porte √† galandage de 100 cm max, soit SDB soit chambre","2 portes √† galandage obligatoires","Des portes √† galandage dans toutes les pi√®ces"],c:1,e:"Le logement doit poss√©der 1 porte √† galandage de largeur 100 cm maximum, soit dans la SDB, soit dans la chambre.",r:"CCCP - Logement S√©nior"},
        {q:"Quel syst√®me de domotique est pr√©conis√© pour le logement senior ?",t:"QCM",a:["KNX standard","OGGA Eco Touch avec protocole EnOcean","Z-Wave","Syst√®me propri√©taire ferm√©"],c:1,e:"Le syst√®me OGGA Eco Touch bas√© sur le protocole EnOcean est pr√©conis√© avec garantie 5 ans.",r:"CCCP - Logement S√©nior"}
    ],
    
    "3. Chauffage et ECS": [
        {q:"Quel est le mode de distribution de chaleur pr√©conis√© ?",t:"QCM",a:["Distribution par air chaud via gaines","Distribution √©lectrique directe par convecteurs","Distribution eau chaude via radiateurs ou planchers chauffants","Distribution mixte selon les logements"],c:2,e:"La distribution sera effectu√©e par eau chaude via radiateurs ou planchers chauffants.",r:"CCCP - Chauffage"},
        {q:"Quelle est la solution de chauffage pr√©conis√©e pour un logement individuel ?",t:"QCM",a:["Chaudi√®re gaz √† condensation","Pompe √† chaleur air/eau (Atlantic Alfea ou Saunier Duval Genia)","Chauffage √©lectrique direct","Raccordement au r√©seau de chaleur"],c:1,e:"Pour les logements individuels, PAC air/eau Atlantic Alfea Extensa A.I. R32 ou Saunier Duval Genia.",r:"CCCP - Chauffage"},
        {q:"Quelle est la particularit√© de la pompe √† chaleur pour les logements interm√©diaires ?",t:"QCM",a:["Elle est g√©othermique","Elle est sur air extrait, sans unit√© ext√©rieure (Nibe)","Elle est hybride avec chaudi√®re gaz","Elle fonctionne uniquement en √©t√©"],c:1,e:"Pour logements interm√©diaires, PAC air/eau monobloc sur air extrait sans unit√© ext√©rieure de marque Nibe.",r:"CCCP - Chauffage"},
        {q:"Quelle est la solution prioritaire pour le chauffage d'un logement collectif ?",t:"QCM",a:["Pompe √† chaleur collective","Chaudi√®re gaz collective","R√©seau de chaleur si pr√©sent","Chauffage √©lectrique individuel"],c:2,e:"La premi√®re solution pr√©conis√©e pour les collectifs est le r√©seau de chaleur s'il est pr√©sent sur le site.",r:"CCCP - Chauffage"},
        {q:"Quel type de thermostat d'ambiance est pr√©conis√© ?",t:"QCM",a:["Thermostat connect√© wifi","Thermostat √† pile","Thermostat filaire (pas √† pile)","Thermostat programmable radio"],c:2,e:"Le cahier prescrit un thermostat d'ambiance filaire (pas √† pile) pour logements individuels et interm√©diaires.",r:"CCCP - Chauffage"},
        {q:"Quel type de syst√®me de production d'ECS est pr√©conis√© ?",t:"QCM",a:["Syst√®me √† accumulation","Syst√®me semi-instantan√©","Syst√®me instantan√© avec accumulation d'√©nergie primaire","Chauffe-eau √©lectrique individuel"],c:2,e:"Les syst√®mes √† accumulation ou semi instantan√©s sont √† proscrire au profit des syst√®mes instantan√©s avec accumulation d'√©nergie primaire.",r:"CCCP - ECS"},
        {q:"Quelle temp√©rature de d√©part ECS doit √™tre garantie pour se pr√©munir des risques de l√©gionelle ?",t:"QCM",a:["50¬∞C","55¬∞C","60¬∞C","65¬∞C"],c:2,e:"La production ECS doit fournir une temp√©rature de d√©part de 60¬∞C pour se pr√©munir des risques de l√©gionelle.",r:"CCCP - ECS"},
        {q:"Quel syst√®me de t√©l√©gestion doit √™tre mis en place pour les syst√®mes collectifs ?",t:"QCM",a:["Syst√®me propri√©taire du fabricant","Syst√®me WIT","Syst√®me KNX","Syst√®me Modbus uniquement"],c:1,e:"Pour les syst√®mes collectifs, t√©l√©gestion WIT compatible avec le syst√®me d'Angers Loire Habitat.",r:"CCCP - Chauffage"},
        {q:"Comment doivent √™tre configur√©es les pompes de distribution pour s√©curiser l'installation ?",t:"QCM",a:["En s√©rie","Doubl√©es en permutation","En cascade","Avec variateur uniquement"],c:1,e:"Les pompes de distribution doivent √™tre doubl√©es pour fonctionner en permutation.",r:"CCCP - Chauffage"},
        {q:"Quel est le r√©gime de temp√©rature pr√©conis√© pour le chauffage ?",t:"QCM",a:["Haute temp√©rature (70-90¬∞C)","Moyenne temp√©rature (50-70¬∞C)","Basse temp√©rature (30-60¬∞C)","Tr√®s basse temp√©rature (20-40¬∞C)"],c:2,e:"Le r√©gime de temp√©rature exerc√© est dit basse temp√©rature avec un r√©seau allant de 30¬∞C √† 60¬∞C.",r:"CCCP - Chauffage"},
        {q:"Quelle est la temp√©rature maximale des t√™tes thermostatiques sur les radiateurs des pi√®ces de vie ?",t:"QCM",a:["19¬∞C","21¬∞C","23¬∞C","25¬∞C"],c:1,e:"Les radiateurs des pi√®ces de vie sont √©quip√©s de t√™tes thermostatiques limit√©es √† 21¬∞C max √† technologie gaz.",r:"CCCP - Chauffage"},
        {q:"Quelle est la temp√©rature minimale √† maintenir dans le r√©seau ECS boucl√© ?",t:"QCM",a:["40¬∞C","45¬∞C","50¬∞C","55¬∞C"],c:2,e:"Pour √™tre conforme √† l'arr√™t√© du 30 novembre 2005 et DTU 60.11, la temp√©rature du r√©seau doit √™tre au minimum √† 50¬∞C.",r:"CCCP - ECS"}
    ],
    
    "4. Portes Coulissantes et Portails": [
        {q:"Quel type de vitrage est prescrit pour les portes coulissantes motoris√©es de hall ?",t:"QCM",a:["Simple vitrage s√©curit","Double vitrage feuillet√© face int√©rieure et s√©curit face ext√©rieure","Triple vitrage","Double vitrage s√©curit des deux faces"],c:1,e:"Double vitrage feuillet√© face int√©rieure et s√©curit face ext√©rieure avec Ud < 1.90 W/m¬≤.K.",r:"CCCP - Portes"},
        {q:"√Ä quelle norme doivent r√©pondre les portes coulissantes automatiques ?",t:"QCM",a:["EN 13241-1","EN 16005","NF P25-362","ISO 9001"],c:1,e:"Les portes coulissantes automatiques doivent r√©pondre √† la norme EN 16005.",r:"CCCP - Portes"},
        {q:"Quelles sont les marques pr√©conis√©es pour les portes coulissantes de hall ?",t:"QCM",a:["SAFIR ou Doitrand","Cib'slide de CIBOX ou Portadapte de Decayeux","URMET ou VIGIK","Aucune marque sp√©cifique"],c:1,e:"Les marques pr√©conis√©es sont : Cib'slide de chez CIBOX, Portadapte coulissante de chez Decayeux.",r:"CCCP - Portes"},
        {q:"Quelle est la force des ventouses √©lectromagn√©tiques pour la fermeture renforc√©e ?",t:"QCM",a:["150 kgs","200 kgs","300 kgs","500 kgs"],c:2,e:"La fermeture renforc√©e est assur√©e par deux ventouses √©lectromagn√©tiques de 300 kgs.",r:"CCCP - Portes"},
        {q:"Quel type de porte de garage doit √™tre mis en place par d√©faut ?",t:"QCM",a:["Porte sectionnelle","Porte basculante non d√©bordante","Porte accord√©on","Porte enroulable"],c:1,e:"Par d√©faut, il doit √™tre mis en place une porte basculante non d√©bordante.",r:"CCCP - Portails"},
        {q:"Quelle est la marque de mat√©riel pr√©conis√©e pour les portes de garage automatiques ?",t:"QCM",a:["CIBOX","Decayeux","SAFIR","URMET"],c:2,e:"Le mat√©riel pr√©conis√© est de marque SAFIR. Doitrand et fabrication artisanale sont √† proscrire.",r:"CCCP - Portails"},
        {q:"Quelle est la prescription concernant la s√©curit√© √† proximit√© de la porte basculante ?",t:"QCM",a:["Installer uniquement des feux clignotants","Un barrage anti ouverture/fermeture et peinture z√©bras noir/jaune obligatoire","Mettre en place un panneau de signalisation uniquement","Installer une alarme sonore"],c:1,e:"Pr√©voir un barrage anti ouverture/fermeture lors de la man≈ìuvre d'un v√©hicule et peinture de sol avec z√©bras noir et jaune obligatoire.",r:"CCCP - Portails"},
        {q:"Quel syst√®me de contr√¥le d'acc√®s est pr√©conis√© pour les portails ?",t:"QCM",a:["Syst√®me KNX","Syst√®me MEMOBIP4B URMET (Bi technologie)","Syst√®me Z-Wave","Syst√®me Bluetooth"],c:1,e:"Syst√®me HF (T√©l√©commande Bi technologie) de type MEMOBIP4B URMET avec programmation logiciel visiosoft web.",r:"CCCP - Portails"}
    ],
    
    "5. Menuiseries Int√©rieures et Ext√©rieures": [
        {q:"En quels mat√©riaux doivent √™tre r√©alis√©es les pi√®ces de quincaillerie ?",t:"QCM",a:["PVC ou nylon","Acier inoxydable ou aluminium moul√©","Zinc","Plastique renforc√©"],c:1,e:"Toutes les pi√®ces de quincaillerie seront r√©alis√©es en acier inoxydable ou en aluminium moul√©. PVC ou nylon interdits.",r:"CCCP - Menuiseries"},
        {q:"Combien de paumelles faut-il pr√©voir sur une menuiserie ouvrant √† la fran√ßaise de hauteur sup√©rieure √† 1,20m ?",t:"QCM",a:["2 paumelles","3 paumelles","4 paumelles","5 paumelles"],c:2,e:"Sur menuiserie ouvrant √† la fran√ßaise, 3 paumelles jusqu'√† 1,20m, et 4 paumelles au-del√†.",r:"CCCP - Menuiseries"},
        {q:"Quelle est la hauteur r√©glementaire des poign√©es de man≈ìuvre selon PMR ?",t:"QCM",a:["0,70m √† 1,10m","0,80m √† 1,20m","0,90m √† 1,30m","1,00m √† 1,40m"],c:2,e:"Les poign√©es de man≈ìuvre seront d'une hauteur comprise entre 0,90m et 1,30m selon r√©glementation PMR.",r:"CCCP - Menuiseries"},
        {q:"Quel est le pourcentage minimum de PVC recycl√© recommand√© pour les menuiseries ?",t:"QCM",a:["10% minimum","20% minimum","30% minimum","50% minimum"],c:2,e:"L'usage de PVC recycl√© √† hauteur de 30% minimum est recommand√©.",r:"CCCP - Menuiseries"},
        {q:"Quelle marque de menuiserie PVC est explicitement √† proscrire ?",t:"QCM",a:["Bouvet","Batistyl","Grosfillex","Fenetrea"],c:2,e:"Le mod√®le doit √™tre √† profil√©s minces type Bouvet, Batistyl, Fenetrea. Grosfillex est √† proscrire.",r:"CCCP - Menuiseries"},
        {q:"Comment doivent √™tre constitu√©es les all√®ges vitr√©es ?",t:"QCM",a:["Double vitrage standard des deux c√¥t√©s","Face ext√©rieure vitrage feuillet√© anti-chute, face int√©rieure vitrage opale","Triple vitrage","Vitrage securit des deux faces"],c:1,e:"Les all√®ges vitr√©es : face ext√©rieure vitrage feuillet√© anti chute, face int√©rieure vitrage opale.",r:"CCCP - Menuiseries"},
        {q:"Dans quel cas les portes-fen√™tres coulissantes en PVC sont-elles autoris√©es ?",t:"QCM",a:["Jamais autoris√©es","Toujours autoris√©es","Uniquement selon projet architectural","Uniquement en rez-de-chauss√©e"],c:2,e:"Si menuiserie PVC, porte-fen√™tre ouvrant √† la fran√ßaise, coulissant autoris√© uniquement selon projet architectural.",r:"CCCP - Menuiseries"},
        {q:"Quelle proportion du tablier de volet roulant doit √™tre ajour√© ?",t:"QCM",a:["1/3 de la surface","1/2 de la surface","2/3 de la surface","3/4 de la surface"],c:2,e:"Le tablier en lames PVC doit comporter une ajouration sur les 2/3 de la surface du tablier.",r:"CCCP - Menuiseries"},
        {q:"Sur quelles baies la man≈ìuvre √©lectrique des volets roulants est-elle syst√©matique ?",t:"QCM",a:["Toutes les baies","Uniquement au rez-de-chauss√©e","Sur les grandes baies (sauf SDB/WC √©ventuel)","Uniquement sur les portes-fen√™tres"],c:2,e:"Man≈ìuvre √©lectrique syst√©matique sur les grandes baies (sauf SDB/WC √©ventuel).",r:"CCCP - Menuiseries"},
        {q:"De quoi doivent obligatoirement √™tre √©quip√©es les portes pali√®res ?",t:"QCM",a:["Uniquement d'une serrure renforc√©e","D'un micro-viseur et d'un entrebailleur","D'un judas √©lectronique","D'une ferme-porte hydraulique"],c:1,e:"Les portes pali√®res seront √©quip√©es d'un micro-viseur et d'un entrebailleur. Paumelles r√©glables tri-dimensionnelles.",r:"CCCP - Menuiseries"},
        {q:"Les cylindres de portes sur organigramme sont-ils autoris√©s ?",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Les cylindres de portes sur organigramme sont √† proscrire.",r:"CCCP - Menuiseries"},
        {q:"Quel type de fa√ßade doit √™tre pr√©vu pour un placard de largeur sup√©rieure √† 80 cm ?",t:"QCM",a:["Fa√ßade pivotante","Fa√ßade coulissante","Fa√ßade battante","Fa√ßade pliante"],c:1,e:"Les placards d'une largeur inf√©rieure √† 80 cm auront une fa√ßade pivotante. Au-del√† de 80 cm, pr√©voir fa√ßade coulissante.",r:"CCCP - Menuiseries"},
        {q:"Quel type de serrure doit √©quiper les portes de gaine technique ?",t:"QCM",a:["Serrure standard √† cl√©","Serrure √† batteuse, √† mortaiser avec triangle type ENEDIS","Serrure √©lectronique","Serrure √† code"],c:1,e:"La porte de gaine doit comporter 1 serrure √† batteuse, √† mortaiser avec triangle type ENEDIS.",r:"CCCP - Menuiseries"},
        {q:"Combien de paumelles faut-il pr√©voir par vantail de porte de gaine ?",t:"QCM",a:["3 paumelles de 120, invisibles autoris√©es","4 paumelles de 140, invisibles √† proscrire","3 paumelles de 140, invisibles √† proscrire","5 paumelles de 120, tous types autoris√©s"],c:1,e:"Il faut 4 paumelles de 140 par vantail. Charni√®res invisibles √† proscrire.",r:"CCCP - Menuiseries"}
    ],
    
    "6. Plomberie et VMC": [
        {q:"En quel mat√©riau doit √™tre l'alimentation eau froide enterr√©e si compteur hors b√¢timent ?",t:"QCM",a:["Cuivre √† sertir","PVC pression","Tube semi-rigide poly√©thyl√®ne","Acier galvanis√©"],c:2,e:"Si compteur g√©n√©ral AEP hors b√¢timent, alimentation eau froide enterr√©e en tube semi-rigide poly√©thyl√®ne.",r:"CCCP - Plomberie"},
        {q:"Quels sont les deux mat√©riaux √† proscrire pour les colonnes montantes eau froide ?",t:"QCM",a:["Cuivre et PER","PVC pression et acier galvanis√©","Multicouches et cuivre","Poly√©thyl√®ne et multicouches"],c:1,e:"Les colonnes montantes doivent √™tre en cuivre/PER/multicouches √† sertir. PVC pression et acier galvanis√© sont √† proscrire.",r:"CCCP - Plomberie"},
        {q:"Quel √©quipement doit obligatoirement √™tre pr√©vu sur chaque pied de colonne montante ?",t:"QCM",a:["Un clapet anti-retour uniquement","Une vanne de coupure avec purge","Un r√©ducteur de pression uniquement","Un compteur divisionnaire"],c:1,e:"Pr√©voir colonne montante √©quip√©e d'une vanne de coupure, avec purge, sur chaque pied de colonne.",r:"CCCP - Plomberie"},
        {q:"Quel type de PVC et syst√®me sont impos√©s pour les √©vacuations verticales en logement ?",t:"QCM",a:["PVC standard, syst√®me libre","PVC acoustique, syst√®me chutunic","PVC renforc√©, syst√®me classique","PVC pression, syst√®me au choix"],c:1,e:"Vertical en PVC acoustique. Imposer le syst√®me de la chutunic.",r:"CCCP - Plomberie"},
        {q:"Les clapets de d√©compression sont-ils autoris√©s ?",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"Les clapets de d√©compression sont interdits.",r:"CCCP - Plomberie"},
        {q:"En quel mat√©riau doivent √™tre les √©vacuations en parties communes ?",t:"QCM",a:["PVC acoustique","Fonte SMU (imp√©ratif dans les parkings)","Cuivre","Multicouches"],c:1,e:"Horizontal et vertical en fonte SMU, imp√©ratif dans les parkings.",r:"CCCP - Plomberie"},
        {q:"Quelles sont les caract√©ristiques de l'√©vier de cuisine prescrit ?",t:"QCM",a:["1 bac et un √©gouttoir (dimension 100)","2 bacs sans √©gouttoir (dimension 120)","2 bacs et un √©gouttoir (dimension 120) en mat√©riau min√©ral composite","1 bac et deux √©gouttoirs (dimension 140)"],c:2,e:"√âvier 2 bacs et un √©gouttoir (dimension 120) en mat√©riau min√©ral composite.",r:"CCCP - Plomberie"},
        {q:"Quel type de m√©canisme √©conomiseur d'eau doit √©quiper le r√©servoir de WC ?",t:"QCM",a:["Simple commande 6 litres","Double commande 3/6 litres","Simple commande 9 litres","Double commande 4/8 litres"],c:1,e:"R√©servoir en c√©ramique √©maill√©e √©quip√© de m√©canisme √©conomiseur d'eau √† double commande 3/6 litres.",r:"CCCP - Plomberie"},
        {q:"Les douches √† l'italienne sont-elles autoris√©es en construction neuve ?",t:"Vrai/Faux",a:["Vrai","Faux"],c:1,e:"En neuf, principe de douche selon r√©glementation accessibilit√© PMR (z√©ro ressaut syst√©matique). Douches √† l'italienne √† proscrire.",r:"CCCP - Plomberie"},
        {q:"Quel type de fermeture de douche est privil√©gi√© ?",t:"QCM",a:["Rideau de douche","2 parois fixes, porte coulissante, verre 4 mm","3 parois fixes fa√Øenc√©es, porte battante en verre s√©curit√© 5 mm min","4 parois fixes, porte pliante, verre 6 mm"],c:2,e:"Privil√©gier 3 parois fixes fa√Øenc√©es, fermeture par porte battante en verre de s√©curit√© √©paisseur 5 mm minimum.",r:"CCCP - Plomberie"},
        {q:"Quel est le classement ECAU requis pour les mitigeurs m√©caniques ?",t:"QCM",a:["NF E1 C2 A1 U2","NF E1 C3 A2 U3","NF E2 C3 A2 U2","NF E1 C2 A3 U3"],c:1,e:"Mitigeurs m√©caniques √† cartouche c√©ramique NF E1 C3 A2 U3 avec garantie constructeur 5 ans minimum.",r:"CCCP - Plomberie"},
        {q:"√Ä quelle temp√©rature maximale doivent √™tre r√©gl√©es les robinetteries de salle de bain ?",t:"QCM",a:["40¬∞C","45¬∞C","50¬∞C","55¬∞C"],c:2,e:"Pour les robinetteries salle de bain, elles devront √™tre r√©gl√©es avec une T¬∞C maximum de 50¬∞C.",r:"CCCP - Plomberie"},
        {q:"Quel type de VMC doit √™tre install√© en logement collectif et individuel ?",t:"QCM",a:["VMC simple flux autor√©glable","VMC simple flux hygror√©glable de type A","VMC simple flux hygror√©glable de type B","VMC double flux"],c:2,e:"Ventilation m√©canique contr√¥l√©e simple flux hygror√©glable de type B (Marque Atlantic ou VIM).",r:"CCCP - Plomberie VMC"},
        {q:"Comment doit √™tre contr√¥l√© le grand d√©bit de la bouche d'extraction de cuisine ?",t:"QCM",a:["Par pile (autonome)","Par d√©tecteur de pr√©sence sur pile","Par bouton poussoir raccord√© √©lectriquement (pile √† proscrire)","Automatiquement par l'humidit√© uniquement"],c:2,e:"Pour la cuisine, contr√¥le du grand d√©bit via un bouton poussoir raccord√© √©lectriquement. Pile √† proscrire.",r:"CCCP - VMC"},
        {q:"Quels sont les mat√©riaux autoris√©s pour les canalisations d'eau chaude ?",t:"QCM",a:["PVC pression et acier galvanis√©","Cuivre √† sertir ou multicouches","Poly√©thyl√®ne standard uniquement","Acier noir uniquement"],c:1,e:"Alimentation en tube cuivre √† sertir ou multicouches.",r:"CCCP - Plomberie"}
    ],
    
    "7. Terrasses et Balcons": [
        {q:"Quels sont les modes de fixation autoris√©s pour les barres accroches √©chelles ?",t:"QCM",a:["Scellement chimique ou goujons m√©caniques uniquement","Vissage simple","Collage","Tous les moyens de fixation"],c:0,e:"Barres accroches √©chelles fix√©es soit par scellement chimique ou par goujons m√©caniques. Aucun autre moyen tol√©r√©.",r:"CCCP - Terrasses"},
        {q:"En quels mat√©riaux doivent √™tre r√©alis√©es les barres accroches √©chelles ?",t:"QCM",a:["PVC renforc√© ou bois","Acier noir uniquement","Acier galvanis√© ou aluminium","Composite uniquement"],c:2,e:"Les barres devront √™tre soit en acier galvanis√© ou en aluminium. Aucun autre mat√©riau tol√©r√©.",r:"CCCP - Terrasses"},
        {q:"Dans quel sens doivent s'ouvrir les trappes d'acc√®s combles ?",t:"QCM",a:["√Ä tirer vers le dernier √©tage","√Ä pousser vers le comble avec syst√®me de v√©rins hydraulique","Coulissante lat√©rale","Sens libre au choix"],c:1,e:"Ouverture √† tirer vers dernier √©tage proscrite. Toutes les ouvertures doivent √™tre √† pousser vers comble avec v√©rins hydraulique.",r:"CCCP - Terrasses"},
        {q:"Quel √©quipement obligatoire doit comporter l'√©chelle d'acc√®s toiture ?",t:"QCM",a:["Uniquement une crosse de sortie","Des crochets obligatoires et une crosse de sortie de toiture rabattable","Un syst√®me anti-chute uniquement","Aucun √©quipement sp√©cifique"],c:1,e:"Mise en place d'√©chelle deux pans avec pr√©sence de crochets obligatoire et crosse de sortie de toiture rabattable.",r:"CCCP - Terrasses"},
        {q:"Quelle est la hauteur minimale d'un garde-corps fixe sur terrasse avec √©quipements ?",t:"QCM",a:["80 cm","90 cm","1 m√®tre","1,10 m√®tre"],c:2,e:"S'il y a des √©quipements techniques : garde-corps fixe hauteur minimale 1m, mat√©riau selon projet architectural.",r:"CCCP - Terrasses"},
        {q:"Comment doit √™tre r√©alis√© le cheminement d'acc√®s √† un √©quipement en terrasse ?",t:"QCM",a:["En b√©ton directement sur l'√©tanch√©it√©","En dalle gravillonn√©e, d√©solidaris√© de l'√©tanch√©it√© par couche n√©opr√®ne","En caillebotis m√©tallique directement pos√©","En bois trait√© sur l'√©tanch√©it√©"],c:1,e:"Cheminement d'acc√®s en dalle gravillonn√©e, d√©solidaris√© de l'√©tanch√©it√© par une couche n√©opr√®ne.",r:"CCCP - Terrasses"},
        {q:"Quelle protection doit √™tre mise en place sur les terrasses v√©g√©talis√©es ?",t:"QCM",a:["Aucune protection n√©cessaire","Protection temporaire uniquement","Protection permanente obligatoire (garde-corps) que des √©quipements soient pr√©sents ou non","Protection selon projet architectural"],c:2,e:"L'entretien annuel indispensable implique de mettre en ≈ìuvre une protection permanente que des √©quipements soient pr√©sents ou non.",r:"CCCP - Terrasses"},
        {q:"Quelle est la pr√©f√©rence architecturale entre loggias et balcons ?",t:"QCM",a:["Les balcons sont pr√©f√©r√©s","Les loggias sont pr√©f√©r√©es (intimisation et portance sur trois c√¥t√©s)","Pas de pr√©f√©rence","Les terrasses uniquement"],c:1,e:"Le projet architectural devra pr√©f√©rer les loggias aux balcons, tant pour intimisation que structurel (portance sur trois c√¥t√©s).",r:"CCCP - Balcons"},
        {q:"Par quoi doit √™tre prot√©g√©e la cunette de liaison au droit des menuiseries ?",t:"QCM",a:["Acier galvanis√©","Caillebotis r√©sine (acier galvanis√© √† proscrire)","PVC renforc√©","Aluminium laqu√©"],c:1,e:"La cunette sera √©tanch√©e avec produits sous avis technique, et prot√©g√©e par caillebotis r√©sine. Acier galvanis√© √† proscrire.",r:"CCCP - Terrasses"},
        {q:"Quelle proportion plein/vide doit √™tre respect√©e pour les garde-corps de balcons ?",t:"QCM",a:["50/50","60/40","70/30","80/20"],c:2,e:"Une proportion de plein/vide de 70/30 sera √† respecter √† minima afin d'intimiser les espaces ext√©rieurs privatifs.",r:"CCCP - Balcons"}
    ],
    
    "8. Contr√¥le d'Acc√®s": [
        {q:"Quelle marque de syst√®me de contr√¥le d'acc√®s est impos√©e ?",t:"QCM",a:["Intratone","Comelit","Aiphone","Urmet"],c:0,e:"Le syst√®me de contr√¥le d'acc√®s doit √™tre de marque Intratone.",r:"CCCP - Contr√¥le Acc√®s"},
        {q:"Quel type de clavier est sp√©cifi√© pour le contr√¥le d'acc√®s ?",t:"QCM",a:["Clavier lumineux r√©tro√©clair√©","Clavier √† code visible","Clavier aveugle avec rep√®re sur la touche 5 et chiffre 1 en haut √† gauche","Clavier √† √©cran tactile"],c:2,e:"Le clavier cod√© sera de type aveugle avec rep√®re sur la touche 5 et le chiffre 1 en haut √† gauche du 5.",r:"CCCP - Contr√¥le Acc√®s"},
        {q:"Quelle est la capacit√© minimale de la centrale de gestion ?",t:"QCM",a:["50 services, distante de 1 m√®tre","100 services, distante d'au moins 2 m√®tres de la t√™te Vigik+","150 services, distante de 3 m√®tres","200 services, pas de distance impos√©e"],c:1,e:"Centrale de gestion 4 portes pouvant recevoir 100 services. Distante d'au moins 2 m√®tres de la t√™te de lecture Vigik+.",r:"CCCP - Contr√¥le Acc√®s"},
        {q:"Quel type d'alimentation est prescrit pour le contr√¥le d'acc√®s ?",t:"QCM",a:["Alimentation secourue obligatoire","Alimentation sur batterie","Alimentation non secourue (les alimentations secourues sont √† proscrire)","Alimentation solaire"],c:2,e:"Alimentation non secourue. Les alimentations secourues sont √† proscrire. En cas de panne, la porte d'entr√©e sera lib√©r√©e.",r:"CCCP - Contr√¥le Acc√®s"},
        {q:"Quelle est la force du bandeau ventouse pour les portes des parties communes ?",t:"QCM",a:["2 x 200 kg","2 x 300 kg","2 x 400 kg (et non de poign√©e ventouse)","2 x 500 kg"],c:2,e:"Les portes pour les parties communes devront imp√©rativement √™tre √©quip√©es de bandeau ventouse (2x 400kg) et non de poign√©e ventouse.",r:"CCCP - Contr√¥le Acc√®s"},
        {q:"Comment est utilis√© le c√¢ble IP en r√©habilitation tous corps d'√©tat ?",t:"QCM",a:["En c√¢ble standard 4 paires","En c√¢ble bus 2 Paires","En c√¢ble coaxial","En fibre optique uniquement"],c:1,e:"En r√©habilitation tous corps d'√©tat : le c√¢ble IP sera utilis√© en c√¢ble bus 2 Paires. Mise en place de combin√©s main libre et mat√©riel 2 Voices GPRS.",r:"CCCP - Contr√¥le Acc√®s"}
    ],
    
    "9. Espaces Verts": [
        {q:"√Ä quoi doit correspondre l'emprise du p√©rim√®tre de protection des arbres pendant travaux ?",t:"QCM",a:["Au diam√®tre du tronc","√Ä l'emprise au sol du houppier","√Ä un rayon de 2 m√®tres autour du tronc","√Ä la hauteur de l'arbre"],c:1,e:"Un p√©rim√®tre de protection doit √™tre install√© autour des arbres pendant travaux. Son emprise doit s'apparenter √† l'emprise au sol du houppier.",r:"CCCP - Espaces Verts"},
        {q:"Qu'est-il interdit de faire dans le p√©rim√®tre de s√©curit√© de l'arbre ?",t:"QCM",a:["Uniquement le stockage de mat√©riaux lourds","Stockage de mat√©riels/mat√©riaux (m√™me terre ou sable) et r√©pandre des produits chimiques","Uniquement circuler avec des engins","Uniquement planter d'autres v√©g√©taux"],c:1,e:"Aucun stockage de mat√©riels et mat√©riaux, m√™me terre ou sable. Aucun produit chimique ne doit √™tre r√©pandu. Les arbres ne doivent pas servir de support.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la distance minimale autoris√©e pour r√©aliser une tranch√©e par rapport √† un tronc ?",t:"QCM",a:["2 m√®tres","3 m√®tres","4 m√®tres","5 m√®tres"],c:2,e:"Aucune tranch√©e ne sera tol√©r√©e √† moins de 4 m√®tres d'un tronc.",r:"CCCP - Espaces Verts"},
        {q:"√Ä partir de quel diam√®tre une racine doit-elle √™tre sci√©e de mani√®re franche ?",t:"QCM",a:["3 centim√®tres","5 centim√®tres","7 centim√®tres","10 centim√®tres"],c:1,e:"Si une racine d'un diam√®tre sup√©rieur √† 5 centim√®tres doit √™tre coup√©e, elle doit √™tre sci√©e de mani√®re franche et non d√©chir√©e pour √©viter les maladies.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la hauteur de la barri√®re anti-racine √† installer pour prot√©ger les r√©seaux ?",t:"QCM",a:["50 cm","80 cm","1 m√®tre","1,20 m√®tre"],c:2,e:"Une barri√®re anti-racine ad√©quate d'un m√®tre de hauteur devra √™tre install√©e pour prot√©ger les r√©seaux situ√©s dans la tranch√©e.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la largeur minimale d'acc√®s pour le passage d'engins dans les espaces verts ?",t:"QCM",a:["2 m√®tres","2,20 m√®tres","2,50 m√®tres","3 m√®tres"],c:2,e:"Pr√©voir un acc√®s suffisamment large pour le passage d'engins : 2.50 m. L'ensemble des gazons devra pouvoir b√©n√©ficier d'un acc√®s d'au moins 2.50 m.",r:"CCCP - Espaces Verts"},
        {q:"Quels rev√™tements sont autoris√©s pour les circulations pi√©tonnes ?",t:"QCM",a:["B√©ton d√©sactiv√© autoris√©, faluns interdits","B√©ton d√©sactiv√©, balay√© ou enrob√© drainant autoris√©s / Faluns, poussier et ar√®ne granitique √† proscrire","Tous rev√™tements autoris√©s","Uniquement enrob√© drainant"],c:1,e:"Le rev√™tement devra √™tre en b√©ton d√©sactiv√©, balay√© ou en enrob√© drainant. Les faluns, poussier et autre ar√®ne granitique sont √† proscrire (Z√©rophyto).",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la largeur de la bande de b√©ton balay√© pr√©conis√©e au pied de b√¢timent ?",t:"QCM",a:["10 cm de pr√©f√©rence √† 20 cm maxi","20 cm de pr√©f√©rence √† 30 cm maxi","30 cm de pr√©f√©rence √† 40 cm maxi","40 cm minimum"],c:1,e:"Une bande de b√©ton balay√© de 20 cm de pr√©f√©rence √† 30 cm maxi dos√© √† 350kg et fibr√©. Le gravier en pied de b√¢timent est √† proscrire.",r:"CCCP - Espaces Verts"},
        {q:"√Ä quelle fr√©quence doivent √™tre install√©es les bouches d'eau dans les espaces verts ?",t:"QCM",a:["Tous les 15 m√®tres","Tous les 20 m√®tres","Tous les 25 m√®tres","Tous les 30 m√®tres"],c:2,e:"Pr√©voir un point d'eau au minimum tous les 25 m√®tres pour assurer un arrosage efficace et pratique.",r:"CCCP - Espaces Verts"},
        {q:"Quelles sont les distances minimales de plantation par rapport au b√¢timent ?",t:"QCM",a:["Arbres 3m, Arbustes 1m","Arbres 4m, Arbustes 1,5m","Arbres 5m, Arbustes 1,5m","Arbres 6m, Arbustes 2m"],c:2,e:"Planter les arbres √† 5 m√®tres du b√¢timent. Planter les arbustes √† 1,5 m√®tre du b√¢timent.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est l'√©paisseur de paillage prescrite pour les massifs apr√®s compactage ?",t:"QCM",a:["5 cm","8 cm","12 cm","15 cm"],c:2,e:"Paillage √† base de plaquettes de peuplier de calibre 10/40 sur une √©paisseur de 12cm apr√®s compactage. Pour plantes vivaces, 5/6 centim√®tres.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la p√©riode autoris√©e pour effectuer les plantations ?",t:"QCM",a:["Avril √† juin","Mai √† septembre","Octobre √† mars","Toute l'ann√©e"],c:2,e:"Les plantations seront effectu√©es entre octobre et mars.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la pente maximale autoris√©e pour les pelouses ?",t:"QCM",a:["5%","10%","15%","20%"],c:1,e:"Pas de pentes sup√©rieures √† 10% pour les pelouses.",r:"CCCP - Espaces Verts"},
        {q:"Quelle est la densit√© de semis prescrite pour l'engazonnement ?",t:"QCM",a:["25 g/m¬≤","30 g/m¬≤","35 g/m¬≤","40 g/m¬≤"],c:2,e:"Semis d'une densit√© de 35g/m¬≤.",r:"CCCP - Espaces Verts"},
        {q:"Quel est le taux d'exigence de r√©ussite des plantations lors du constat de reprise ?",t:"QCM",a:["85%","90%","95%","100%"],c:2,e:"Le constat de reprise des arbres est effectu√© entre le 15 ao√ªt et le 15 octobre : exigence de r√©ussite des plantations fix√©e √† 95%.",r:"CCCP - Espaces Verts"}
    ]
}
;
        
        // Fonction de conversion automatique du format condens√© vers format √©tendu
        function expandQuizData(compact) {
            const expanded = {};
            for (const [theme, questions] of Object.entries(compact)) {
                expanded[theme] = questions.map(q => ({
                    question: q.q,
                    type: q.t,
                    answers: q.a,
                    correct: q.c,
                    explanation: q.e,
                    reference: q.r
                }));
            }
            return expanded;
        }
        
        // Conversion et assignation
        const quizData = expandQuizData(quizDataCompact);


        // ==================== GAME STATE ====================
        let userRole = null;
        let sessionId = null;
        let teamName = null;
        let gameState = {
            teams: [],
            currentTheme: null,
            currentQuestionIndex: 0,
            answers: {},
            scores: {},
            completedThemes: []
        };

        // ==================== STORAGE FUNCTIONS ====================
        function saveGameState() {
            if (sessionId) {
                localStorage.setItem(`quiz_${sessionId}`, JSON.stringify(gameState));
            }
        }

        function loadGameState() {
            if (sessionId) {
                const saved = localStorage.getItem(`quiz_${sessionId}`);
                if (saved) {
                    gameState = JSON.parse(saved);
                    return true;
                }
            }
            return false;
        }

        function watchGameState() {
            if (userRole === 'player' && sessionId) {
                setInterval(() => {
                    loadGameState();
                    updatePlayerView();
                }, 1000);
            }
        }

        // ==================== ROLE SELECTION ====================
        function selectRole(role) {
            userRole = role;
            document.getElementById('roleScreen').classList.add('hidden');
            
            if (role === 'admin') {
                document.getElementById('adminSetupScreen').classList.remove('hidden');
            } else {
                document.getElementById('playerJoinScreen').classList.remove('hidden');
            }
        }

        // ==================== ADMIN FUNCTIONS ====================
        function createSession() {
            sessionId = Math.random().toString(36).substr(2, 6).toUpperCase();
            document.getElementById('sessionId').textContent = sessionId;
            document.getElementById('sessionIdDisplay').classList.remove('hidden');
            document.getElementById('teamManagement').classList.remove('hidden');
            
            gameState = {
                teams: [],
                currentTheme: null,
                currentQuestionIndex: 0,
                answers: {},
                scores: {},
                completedThemes: []
            };
            saveGameState();
        }

        function addTeam() {
            const input = document.getElementById('teamNameInput');
            const name = input.value.trim();
            
            if (name && !gameState.teams.includes(name)) {
                gameState.teams.push(name);
                gameState.scores[name] = 0;
                input.value = '';
                saveGameState();
                renderTeamsGrid();
            }
        }

        function renderTeamsGrid() {
            const grid = document.getElementById('teamsGrid');
            grid.innerHTML = gameState.teams.map(team => `
                <div class="team-card">
                    <div class="team-name">${team}</div>
                    <div class="team-status">Pr√™t</div>
                </div>
            `).join('');
        }

        function startQuizSession() {
            if (gameState.teams.length < 2) {
                alert('Ajoutez au moins 2 √©quipes pour commencer.');
                return;
            }
            
            document.getElementById('adminSetupScreen').classList.add('hidden');
            document.getElementById('themeScreen').classList.remove('hidden');
            renderThemes();
        }

        function renderThemes() {
            const grid = document.getElementById('themeGrid');
            const themes = Object.keys(quizData);
            
            grid.innerHTML = themes.map(theme => {
                const questionCount = quizData[theme].length;
                const isCompleted = gameState.completedThemes.includes(theme);
                return `
                    <div class="theme-card ${userRole === 'player' ? 'disabled' : ''}" 
                         onclick="${userRole === 'admin' ? `selectTheme('${theme}')` : ''}">
                        <div class="theme-title">${theme}</div>
                        <div class="theme-info">
                            üìù ${questionCount} questions
                            ${isCompleted ? '<br>‚úÖ Compl√©t√©e' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function selectTheme(theme) {
            if (userRole !== 'admin') return;
            
            gameState.currentTheme = theme;
            gameState.currentQuestionIndex = 0;
            gameState.answers = {};
            saveGameState();
            
            document.getElementById('themeScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            displayQuestion();
            watchGameState();
        }

        // ==================== PLAYER FUNCTIONS ====================
        function validateSession() {
            const input = document.getElementById('sessionIdInput');
            sessionId = input.value.trim().toUpperCase();
            
            if (loadGameState()) {
                document.getElementById('teamSelection').classList.remove('hidden');
                const select = document.getElementById('teamSelect');
                select.innerHTML = gameState.teams.map(team => 
                    `<option value="${team}">${team}</option>`
                ).join('');
            } else {
                alert('Session introuvable. V√©rifiez l\'ID.');
            }
        }

        function joinAsTeam() {
            const select = document.getElementById('teamSelect');
            teamName = select.value;
            
            if (teamName) {
                document.getElementById('playerJoinScreen').classList.add('hidden');
                
                if (gameState.currentTheme) {
                    document.getElementById('quizScreen').classList.remove('hidden');
                    displayQuestion();
                    watchGameState();
                } else {
                    document.getElementById('themeScreen').classList.remove('hidden');
                    renderThemes();
                    watchGameState();
                }
            }
        }

        function updatePlayerView() {
            if (gameState.currentTheme && document.getElementById('quizScreen').classList.contains('hidden')) {
                document.getElementById('themeScreen').classList.add('hidden');
                document.getElementById('quizScreen').classList.remove('hidden');
                displayQuestion();
            }
            
            if (!gameState.currentTheme && !document.getElementById('themeScreen').classList.contains('hidden')) {
                renderThemes();
            }
            
            renderTeamAnswersGrid();
        }

        // ==================== QUIZ FUNCTIONS ====================
        function displayQuestion() {
            if (!gameState.currentTheme) return;
            
            const question = quizData[gameState.currentTheme][gameState.currentQuestionIndex];
            const totalQuestions = quizData[gameState.currentTheme].length;
            
            document.getElementById('questionNumber').textContent = 
                `Question ${gameState.currentQuestionIndex + 1}/${totalQuestions}`;
            document.getElementById('questionType').textContent = question.type;
            document.getElementById('questionText').textContent = question.question;
            
            const answersGrid = document.getElementById('answersGrid');
            const hasAnswered = gameState.answers[`q${gameState.currentQuestionIndex}`]?.[teamName] !== undefined;
            
            answersGrid.innerHTML = question.answers.map((answer, index) => {
                const isSelected = gameState.answers[`q${gameState.currentQuestionIndex}`]?.[teamName] === index;
                return `
                    <div class="answer-option ${isSelected ? 'selected' : ''} ${hasAnswered ? 'disabled' : ''}" 
                         onclick="${!hasAnswered && userRole === 'player' ? `selectAnswer(${index})` : ''}">
                        <span class="answer-label">${String.fromCharCode(65 + index)}.</span>
                        <span>${answer}</span>
                    </div>
                `;
            }).join('');
            
            // Update progress
            const progress = ((gameState.currentQuestionIndex + 1) / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Show/hide buttons and waiting message
            if (userRole === 'player') {
                document.getElementById('submitBtn').classList.toggle('hidden', hasAnswered);
                document.getElementById('playerWaiting').classList.toggle('hidden', !hasAnswered);
                document.getElementById('nextBtn').classList.add('hidden');
            } else {
                document.getElementById('submitBtn').classList.add('hidden');
                document.getElementById('playerWaiting').classList.add('hidden');
                const allAnswered = gameState.teams.every(t => 
                    gameState.answers[`q${gameState.currentQuestionIndex}`]?.[t] !== undefined
                );
                document.getElementById('nextBtn').classList.toggle('hidden', !allAnswered);
            }
            
            renderTeamAnswersGrid();
        }

        function selectAnswer(index) {
            if (userRole !== 'player') return;
            
            const options = document.querySelectorAll('.answer-option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
        }

        function submitAnswer() {
            if (userRole !== 'player') return;
            
            const selected = document.querySelector('.answer-option.selected');
            if (!selected) {
                alert('Veuillez s√©lectionner une r√©ponse !');
                return;
            }
            
            const selectedIndex = Array.from(document.querySelectorAll('.answer-option')).indexOf(selected);
            const question = quizData[gameState.currentTheme][gameState.currentQuestionIndex];
            
            // Store answer
            if (!gameState.answers[`q${gameState.currentQuestionIndex}`]) {
                gameState.answers[`q${gameState.currentQuestionIndex}`] = {};
            }
            gameState.answers[`q${gameState.currentQuestionIndex}`][teamName] = selectedIndex;
            
            // Update score if correct
            if (selectedIndex === question.correct) {
                gameState.scores[teamName]++;
            }
            
            saveGameState();
            displayQuestion();
        }

        function renderTeamAnswersGrid() {
            const grid = document.getElementById('teamAnswersGrid');
            const currentQ = `q${gameState.currentQuestionIndex}`;
            
            grid.innerHTML = gameState.teams.map(team => {
                const hasAnswered = gameState.answers[currentQ]?.[team] !== undefined;
                return `
                    <div class="team-card ${team === teamName ? 'active' : ''}">
                        <div class="team-name">${team}</div>
                        <div class="team-status ${hasAnswered ? 'team-answered' : ''}">
                            ${hasAnswered ? '‚úì R√©pondu' : '‚è≥ En attente'}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function nextQuestion() {
            if (userRole !== 'admin') return;
            
            gameState.currentQuestionIndex++;
            
            if (gameState.currentQuestionIndex < quizData[gameState.currentTheme].length) {
                saveGameState();
                displayQuestion();
            } else {
                showScores();
            }
        }

        function showScores() {
            if (!gameState.completedThemes.includes(gameState.currentTheme)) {
                gameState.completedThemes.push(gameState.currentTheme);
            }
            saveGameState();
            
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('scoresScreen').classList.remove('hidden');
            document.getElementById('currentThemeName').textContent = gameState.currentTheme;
            
            renderScores();
        }

        function renderScores() {
            const sortedTeams = [...gameState.teams].sort((a, b) => 
                gameState.scores[b] - gameState.scores[a]
            );
            
            const container = document.getElementById('scoresContainer');
            container.innerHTML = sortedTeams.map((team, index) => `
                <div class="score-row">
                    <div class="score-rank">#${index + 1}</div>
                    <div class="score-name">${team}</div>
                    <div class="score-points">${gameState.scores[team]} pts</div>
                </div>
            `).join('');
        }

        function showReview() {
            document.getElementById('scoresScreen').classList.add('hidden');
            document.getElementById('reviewScreen').classList.remove('hidden');
            document.getElementById('reviewThemeName').textContent = gameState.currentTheme;
            
            const container = document.getElementById('reviewContainer');
            const questions = quizData[gameState.currentTheme];
            
            container.innerHTML = questions.map((q, index) => `
                <div class="review-question">
                    <div class="review-header">
                        <div class="review-number">Q${index + 1}</div>
                        <div class="review-text">${q.question}</div>
                    </div>
                    <div class="review-answer">
                        <strong>‚úì Bonne r√©ponse :</strong> ${q.answers[q.correct]}
                    </div>
                    <div class="review-explanation">
                        <div class="explanation-title">üí° Explication</div>
                        ${q.explanation}
                        <br><br>
                        <em>R√©f√©rence : ${q.reference}</em>
                    </div>
                </div>
            `).join('');
        }

        function backToThemes() {
            gameState.currentTheme = null;
            gameState.currentQuestionIndex = 0;
            gameState.answers = {};
            saveGameState();
            
            document.getElementById('reviewScreen').classList.add('hidden');
            document.getElementById('finalScoresScreen').classList.add('hidden');
            document.getElementById('themeScreen').classList.remove('hidden');
            renderThemes();
        }

        function showFinalScores() {
            document.getElementById('themeScreen').classList.add('hidden');
            document.getElementById('finalScoresScreen').classList.remove('hidden');
            
            const sortedTeams = [...gameState.teams].sort((a, b) => 
                gameState.scores[b] - gameState.scores[a]
            );
            
            const container = document.getElementById('finalScoresContainer');
            container.innerHTML = sortedTeams.map((team, index) => `
                <div class="score-row">
                    <div class="score-rank">${index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '#' + (index + 1)}</div>
                    <div class="score-name">${team}</div>
                    <div class="score-points">${gameState.scores[team]} points</div>
                </div>
            `).join('');
        }

        function resetSession() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser la session ?')) {
                localStorage.removeItem(`quiz_${sessionId}`);
                location.reload();
            }
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Add enter key support for inputs
            document.getElementById('teamNameInput')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addTeam();
            });
            
            document.getElementById('sessionIdInput')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') validateSession();
            });
        });
    </script>
</body>
</html>
